name: Publish tune-dms to PyPI

on:
    release:
        types: [published]

jobs:
    publish:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v4
            - uses: actions/setup-python@v5
              with:
                  python-version: '3.10'
            - name: Install build
              run: pip install build twine
            - name: Build tune-dms
              run: python -m build
              working-directory: packages/tune_dms
            - name: Publish to PyPI
              env:
                  TWINE_USERNAME: __token__
                  TWINE_PASSWORD: ${{ secrets.PYPI_API_TOKEN }}
              run: twine upload packages/tune_dms/dist/*
